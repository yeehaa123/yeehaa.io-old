---
import Base from "../layouts/base.astro";
import { getCollection } from "astro:content";
import Section from "../components/about/SectionSelector.astro";
const entries = await getCollection("About");
const sections = await Promise.all(
  entries
    .sort((a, b) => a.data.order - b.data.order)
    .map(async ({ slug, render }) => {
      const rendered = await render();
      console.log(slug);
      return { slug, ...rendered };
    })
);
---

<Base>
  {sections.map((s, i) => <Section {...s} index={i} />)}
</Base>

<style is:global>
  @import "open-props/media";
  main {
    display: grid;
  }
  #flaws {
    background-color: var(--fire);
  }
  @media (--md-n-above) {
    main {
      display: grid;
      gap: var(--size-8);
      grid-template-columns: repeat(5, 1fr);
    }
    #opening {
      grid-column: span 5;
    }

    #background {
      grid-column: span 2;
    }

    #context {
      grid-column: span 3;
      margin-block-start: 100px;
    }

    #flaws {
      grid-column: span 3;
      margin-block-start: -100px;
    }

    #conflict {
      grid-column: span 2;
      align-items: flex-start;
      justify-content: flex-end;
      display: flex;
      margin-block-end: 25%;
      flex-direction: column;
    }

    #problem {
      grid-column: span 5;
    }
  }
</style>
